$(function(){function n(n){$("#ajaxLi>li").each(function(e){function p(n,a,e){var o="";if(a<6)for(var i=0;i<a;i++)o+="<b title='等级:"+a+"' style='background-position: center -17px'></b>";else if(a<20)for(var i=0;i<parseInt(a/3);i++)o+="<b title='等级:"+a+"' style='background-position: center -35px'></b>";else for(var i=0;i<parseInt(a/10);i++)o+="<b title='等级:"+a+"' style='background-position: center -78px'></b>";$(e).html("<span>"+$(t).eq(n)[0].shop_name+"</span>店铺名字"+o)}function s(n){v.setContent(n.target.content),v.open(a,n.target.getPosition())}o>0&&i[e].setMap(null);var r=$("#ajaxLi>li:nth-child("+(e+1)+") .clear"),l=$(r).find(".mainInfo>p:nth-child(2)");$(l).html("<span>主营:</span>"+$(t).eq(e)[0].main);var c=$(r).find(".mainInfo>p:nth-child(3)");c.html("<span>地址:</span>"+$(t).eq(e)[0].addr);var h=$(r).find(".slideInfo>p:nth-child(3)>span");h.html(""),h.html(h.html()+$(t).eq(e)[0].shop_visit);var d=$(r).find($("button>a"));$(d).attr("href","http://172.18.32.184:2333/html/shopInfo.html?index="+e+"&page="+n);var f=$(r).find(".mainInfo>p:nth-child(1)");$(f).html("");var m=$(t).eq(e)[0].level;p(e,m,f);var u=$(t).eq(e)[0].map_latitude,g=$(t).eq(e)[0].map_longitude,v=new AMap.InfoWindow({offset:new AMap.Pixel(0,-30)});i[e]=new AMap.Marker({position:[g,u],map:a}),i[e].setMap(a),i[e].content="<div class='pop-window'><h3><b>众诚365数据恢复中心</b></h3><p><span>主营:</span>"+$(t).eq(e)[0].main+"</p><p><span>地址:</span>"+$(t).eq(e)[0].addr+"</p><a href=''>进入店铺</a></div>",i[e].on("click",s),a.setFitView()}),o++}$("#matte").slideDown(1),$("#map").slideDown(1);var a=new AMap.Map("container",{resizeEnable:!0,zoom:10});AMap.plugin(["AMap.ToolBar","AMap.Scale","AMap.OverView"],function(){a.addControl(new AMap.ToolBar),a.addControl(new AMap.Scale),a.addControl(new AMap.OverView({isOpen:!1}))}),$(".page>span:nth-child(3)").css({backgroundColor:"darkorange",color:"whitesmoke",border:"solid 1px darkorange",fontSize:"16px"}),$("header>section>nav,.mainContent,footer,#chaCity button").on("click",function(n){$("#chaCity").slideUp(100)}),$(".chaCity").on("click",function(n){n.preventDefault(),$("#chaCity").slideDown(100),$("#hotCity").html("");var a=["北京","上海","广州","天津","西安","深圳","武汉","成都","重庆","南京","沈阳","杭州","济南","郑州","青岛","苏州"];$(a).each(function(n){$("#hotCity").html($("#hotCity").html()+"<span>"+$(a).eq(n)[0]+"<span>")}),n.stopImmediatePropagation()});var t=null;$.ajax({url:"/shop/json/1",dataType:"json",type:"get",success:function(a){t=a.shop_data;var e=1;n(e)}});var e=$("#ajaxLi>li").length;$(".page>span").each(function(){$(this).on("click",function(a){var o=$(this).html();$(".page span").css({backgroundColor:"",color:"",border:"",fontWeight:""}),$(".page>span").each(function(n){$(this).html()==o&&$(this).css({backgroundColor:"darkorange",color:"whitesmoke",border:"solid 1px darkorange",fontWeight:"600"})}),$.ajax({url:"/shop/json/"+o,dataType:"json",type:"get",success:function(a){t=a.shop_data,n(o);for(var i=0;i<e;i++);}})})});var o=0,i={};$("#getMap").on("click",function(n){$("#matte").slideDown(200),setTimeout(function(){$("#map").slideDown(500)},500)}),$("#map h5 span").on("click",function(n){$("#map").slideUp(1e3),setTimeout(function(){$("#matte").slideUp(200)},1e3)})});